/* ==UserStyle==
@name Hide Youtube BS
@namespace github.com/Dheatly23/Custom-Patches-For-Youtube
@version 1.3.0
@description Clean up Youtube's BS to make watching experience better
@author Dheatly23
@homepageURL https://github.com/Dheatly23/Custom-Patches-For-Youtube
@supportURL https://github.com/Dheatly23/Custom-Patches-For-Youtube
@license Apache-2.0

@preprocessor less
@var select membersVideo "Membership Video" ["show", "hide", "soft-hide"]
@var select fundraiserVideo "Fundraiser Video" ["show", "hide", "soft-hide"]
@var select autoDubVideo "Auto Dubbed Video" ["show", "hide", "soft-hide"]
@var select verifiedVideo "Verified Video" ["show", "hide", "soft-hide"]
@var select superThanksComment "Super Thanks Comment" ["show", "hide", "soft-hide"]
@var select membersComment "Members Comment" ["show", "hide", "soft-hide"]
@var select heartComment "Hearted Comment" ["show", "hide", "soft-hide"]
@var select verifiedComment "Verified (and Artist) User Comment" ["show", "hide", "soft-hide"]
@var select pinnedComment "Pinned Comment" ["show", "hide", "soft-hide"]
@var select upsellEmoji "Members Only Emoji" ["show", "hide", "soft-hide"]
@var select aiSummary "AI Summary" ["show", "hide", "soft-hide", "replace"]
@var select clarifyBox "Info Box Underneath Video" ["show", "hide", "soft-hide", "replace"]
@var select joinButton "Join Button" ["show", "hide", "soft-hide"]
@var select superThanksButton "Super Thanks Button" ["show", "hide", "soft-hide"]
@var select shareButton "Share Button" ["show", "hide", "soft-hide"]
@var select downloadButton "Download Button" ["show", "hide", "soft-hide"]
@var select saveButton "Save Button" ["show", "hide", "soft-hide"]
@var select clipButton "Clip Button" ["show", "hide", "soft-hide"]
@var select createButton "Create Button" ["show", "hide", "soft-hide"]
@var select mikeSearchButton "Mike Button Beside Search Box" ["show", "hide", "soft-hide"]
==/UserStyle== */

@-moz-document domain("youtube.com") {
    /* Youtube site */
    /* Hide ðŸ–• */
    .hide(hide) {
        display: none;
    }

    /* Soft hide ðŸ‘ */
    .hide(soft-hide) {
        filter: grayscale(75%) opacity(10%);
    }

    /* Rest ðŸ‘Ž */
    .hide(@p) {}

    /* Replace ðŸ¥° */
    .replace(@elem, @text, @sel: "> *") {
        @temp: e(@sel);
        @{temp} {
            display: none;
        }

        &::before when (@elem = before) {
            content: @text;
        }

        &::after when (@elem = after) {
            content: @text;
        }
    }

    /* Sandwich replace ðŸ¥ª */
    .sandwich(@before, @after) {
        &::before {
            content: @before;
        }

        &::after {
            content: @after;
        }
    }

    /* Subscription and channel videos */
    ytd-rich-item-renderer.ytd-rich-grid-renderer {
        /* Fuck membership */
        &:has(ytd-badge-supported-renderer > .badge-style-type-members-only) {
            .hide(@membersVideo);
        }

        /* Begone beggars */
        &:has(ytd-badge-supported-renderer > .badge-style-type-ypc) {
            .hide(@fundraiserVideo);
        }

        /* Unverify raygun ðŸ”« */
        &:has(.yt-core-attributed-string .ytSpecIconShapeHost) {
            .hide(@verifiedVideo);
        }
    }

    /* Recommended video */
    yt-lockup-view-model.ytd-item-section-renderer,
    /* Probably remnant of an old UI? Only seen it for shorts */
    ytd-compact-video-renderer.ytd-item-section-renderer {
        /* Haven't seen any members-only video got recommended yet (thank goodness ðŸ˜‡) */
        /* Begone beggars (this might be not too accurate selector) */
        &:has(badge-shape.yt-badge-shape--commerce),
        /* Probably remnant of an old UI? (ARIA label is only predicted lmao) */
        &:has(ytd-badge-supported-renderer.badges > [aria-label = "Fundraiser"]) {
            .hide(@fundraiserVideo);
        }

        /* Fuck AI dubbing (i don't like d attribute selector but ehhhhhhhhhhh) */
        &:has(badge-shape.yt-badge-shape--default > .yt-badge-shape__icon svg [d = "M19.4.2a1 1 0 00-.2 1.4 9 9 0 01-.022 10.83 1 1 0 001.595 1.206A11 11 0 0020.8.4a1 1 0 00-1.4-.2ZM10 2a5 5 0 100 10 5 5 0 000-10Zm6.17.3a1 1 0 00-.028 1.414c.895.932 1.365 2.114 1.358 3.312-.006 1.199-.49 2.378-1.396 3.302a1.001 1.001 0 101.427 1.4c1.257-1.281 1.959-2.953 1.969-4.69.009-1.738-.673-3.416-1.916-4.71A1 1 0 0016.17 2.3ZM10 13a8 8 0 00-8 8 1 1 0 001 1h14l.102-.005A1 1 0 0018 21a8 8 0 00-8-8Z"]),
        /* Probably remnant of an old UI? */
        &:has(ytd-badge-supported-renderer.badges > [aria-label = "Auto-dubbed"]) {
            .hide(@autoDubVideo);
        }

        /* Unverify raygun ðŸ”« */
        &:has(.yt-core-attributed-string .ytSpecIconShapeHost),
        /* Probably remnant of an old UI? */
        &:has(ytd-badge-supported-renderer.ytd-channel-name > [aria-label = "Verified"]) {
            .hide(@verifiedVideo);
        }
    }

    /* Template for comment */
    .comment(@v) {
        /* Entire comment thread */
        ytd-comment-thread-renderer.ytd-item-section-renderer:has(> #comment-container &),
        /* Comment reply */
        ytd-comment-view-model.ytd-comment-replies-renderer:has(&) {
            .hide(@v);
        }
    }

    /* Fuck super thanks */
    yt-pdg-comment-chip-renderer:not([hidden]) {
        .comment(@superThanksComment);
    }

    /* Members gets findommed */
    ytd-sponsor-comment-badge-renderer {
        .comment(@membersComment);
    }

    /* Fuck preferential treatment */
    ytd-creator-heart-renderer:not(:empty) {
        .comment(@heartComment);
    }

    /* Verify my ass */
    ytd-author-comment-badge-renderer {
        .comment(@verifiedComment);
    }

    /* Pin::into_inner_unchecked */
    ytd-pinned-comment-badge-renderer {
        .comment(@pinnedComment);
    }

    /* Motherfucking LINE sticker clone from Tokopedia (â•¯â€µâ–¡â€²)â•¯ï¸µâ”»â”â”» */
    yt-emoji-picker-upsell-category-renderer.yt-emoji-picker-renderer {
        .hide(@upsellEmoji);
    }

    /* Super chat (pending) */
    /* Artificial Idiot box is back in style ðŸ˜Ž */
    ytd-expandable-metadata-renderer.ytd-watch-flexy:has(video-summary-content-view-model) {
        /* Hideous replacement here */
        .handle(replace) {
            &:not(:hover) {
                #expanded-title-subtitle-text {
                    > #expanded-title:first-child {
                        .replace(before, "ðŸ¤– Beep Boop I Am An Idiot");
                    }

                    > #expanded-subtitle > a {
                        .replace(before, "Youtube did not do QA", "yt-formatted-string:first-child");
                    }
                }

                #collapsed-label {
                    .replace(after, "Retard Box", "yt-formatted-string");
                }

                p {
                    .replace(after, "Youtube wants to artificially sand your intelligence off. With our infinite wisdom, we replaced this bullshit, useless box, that you won\'t ever read with our own text ðŸ¤ª. (Hover over to \22restore\22  to original)");
                }

                #collapsed-title {
                    .replace(after, "â›” Spoiler blocker â›” (Hover over to \22restore\22  to original)");
                }

                like-button-view-model {
                    display: none;
                }
            }
        }

        .handle(@v) {
            .hide(@v);
        }

        .handle(@aiSummary);
    }

    /* Fuck your freedom to think */
    #clarify-box.attached-message {
        /* Hideous replacement here */
        .handle(replace) {
            &:not(:hover) {
                h2 yt-formatted-string {
                    .sandwich("Youtube want to dictate your knowledge about \22", "\22  (massive air quotes there ðŸ˜‰)");
                }

                #paragraph {
                    .replace(after, "Youtube wants to tell you to fuck your agency right off. With our infinite wisdom, we replaced this bullshit, useless box, that you won\'t ever read with our own text ðŸ¤£. (Hover over to \22restore\22  to original)");
                }

                yt-formatted-string.disclaimer {
                    > span:first-child {
                        display: none;
                    }

                    &::before {
                        content: "Disclaimer: Alphabet Inc. is wholly responsible for this ðŸ’©.";
                    }

                    > a:last-child::after {
                        content: " (or don't)";
                    }
                }
            }
        }

        .handle(@v) {
            .hide(@v);
        }

        .handle(@clarifyBox);
    }

    /* Fuck membership xðŸ’¯ */
    :is(yt-flexible-actions-view-model, ytd-video-owner-renderer.ytd-watch-metadata) > :has(button[aria-label = "Join this channel"]) {
        .hide(@joinButton) !important;
    }

    /* Might not be exactly join "button" but it's fucking annoying
     * (To future maintainer, it's a members showcase thingy in channel homepage)
    **/
    ytd-item-section-renderer.ytd-section-list-renderer:has(ytd-recognition-shelf-renderer) {
        .hide(@joinButton);
    }

    /* Button beside like/dislike */
    yt-button-view-model.ytd-menu-renderer {
        /* Share the my ass */
        &:has(> button-view-model > button[aria-label = "Share"]) {
            .hide(@shareButton);
        }

        /* Ik it's youtube thing but IMHO it's useless af */
        &:has(> button-view-model > button[aria-label = "Save to playlist"]) {
            .hide(@saveButton);
        }

        /* No thanks ðŸ‘®â€â™‚ï¸ðŸ¤š */
        &:has(> button-view-model > button[aria-label = "Thanks"]) {
            .hide(@superThanksButton);
        }

        /* Clip my goatse */
        &:has(> button-view-model > button[aria-label = "Clip"]) {
            .hide(@clipButton);
        }
    }

    /* YT-DLP FTW!!!!! ðŸ˜Ž */
    ytd-download-button-renderer.ytd-menu-renderer {
        .hide(@downloadButton);
    }

    /* Top bar buttons */
    ytd-button-renderer.ytd-masthead {
        /* Fuschia is not a creative color */
        &:has(> yt-button-shape > button[aria-label = "Create"]) {
            .hide(@createButton) !important;
        }

        /* Who the fuck use voice search ðŸ¤¨ */
        &:has(> yt-button-shape > button[aria-label = "Search with your voice"]) {
            .hide(@mikeSearchButton);
        }
    }
}
