/* ==UserStyle==
@name Hide Youtube BS
@namespace github.com/Dheatly23/Custom-Patches-For-Youtube
@version 1.7.1
@description Clean up Youtube's BS to make watching experience better
@author Dheatly23
@homepageURL https://github.com/Dheatly23/Custom-Patches-For-Youtube
@supportURL https://github.com/Dheatly23/Custom-Patches-For-Youtube
@license Apache-2.0

@preprocessor less
@var select membersVideo "Membership Video" ["show", "hide", "soft-hide"]
@var select fundraiserVideo "Fundraiser Video" ["show", "hide", "soft-hide"]
@var select autoDubVideo "Auto Dubbed Video" ["show", "hide", "soft-hide"]
@var select verifiedVideo "Verified Video" ["show", "hide", "soft-hide"]
@var select collabVideo "Collab Video (might not be perfect)" ["show", "hide", "soft-hide"]
@var select liveVideo "Live Video" ["show", "hide", "soft-hide"]
@var select musicVideo "Music Video" ["show", "hide", "soft-hide"]
@var select superThanksComment "Super Thanks Comment" ["show", "hide", "soft-hide"]
@var select membersComment "Members Comment" ["show", "hide", "soft-hide"]
@var select heartComment "Hearted Comment" ["show", "hide", "soft-hide"]
@var select verifiedComment "Verified (and Artist) User Comment" ["show", "hide", "soft-hide"]
@var select pinnedComment "Pinned Comment" ["show", "hide", "soft-hide"]
@var select voiceComment "Voice Comment" ["show", "hide", "soft-hide"]
@var select shortsComment "Shorts Comment" ["show", "hide", "soft-hide"]
@var select upsellEmoji "Members Only Emoji" ["show", "hide", "soft-hide"]
@var select superChat "Super Chat" ["show", "hide", "soft-hide"]
@var select membersChat "Members Chat" ["show", "hide", "soft-hide"]
@var select moderatorChat "Moderator Chat" ["show", "hide", "soft-hide"]
@var select ownerChat "Channel Owner Chat" ["show", "hide", "soft-hide"]
@var select aiSummary "AI Summary" ["show", "hide", "soft-hide", "replace"]
@var select clarifyBox "Info Box Underneath Video" ["show", "hide", "soft-hide", "replace"]
@var select chatInfoBox "Live Chat Notice Box" ["show", "hide", "soft-hide", "replace"]
@var select teaserCarousel "Whatever The Fuck Is Beside Description" ["show", "hide", "soft-hide", "smaller"]
@var select joinButton "Join Button" ["show", "hide", "soft-hide"]
@var select superThanksButton "Super Thanks Button" ["show", "hide", "soft-hide"]
@var select superChatButton "Super Chat Button" ["show", "hide", "soft-hide"]
@var select shareButton "Share Button" ["show", "hide", "soft-hide"]
@var select downloadButton "Download Button" ["show", "hide", "soft-hide"]
@var select saveButton "Save Button" ["show", "hide", "soft-hide"]
@var select clipButton "Clip Button" ["show", "hide", "soft-hide"]
@var select createButton "Create Button" ["show", "hide", "soft-hide"]
@var select mikeSearchButton "Mike Button Beside Search Box" ["show", "hide", "soft-hide"]
@var select aiButton "AI Button" ["show", "hide", "soft-hide"]
==/UserStyle== */

@-moz-document domain("youtube.com") {
    /* Youtube site */
    /* Hide ðŸ–• */
    .hide(hide) {
        display: none;
    }

    /* Soft hide ðŸ‘ */
    .hide(soft-hide) {
        filter: grayscale(75%) opacity(10%);
    }

    /* Rest ðŸ‘Ž */
    .hide(@p) {}

    /* Replace ðŸ¥° */
    .replace(@elem, @text, @sel: "> *") {
        @temp: e(@sel);
        @{temp} {
            display: none;
        }

        &::before when (@elem = before) {
            content: @text;
        }

        &::after when (@elem = after) {
            content: @text;
        }
    }

    /* Sandwich replace ðŸ¥ª */
    .sandwich(@before, @after) {
        &::before {
            content: @before;
        }

        &::after {
            content: @after;
        }
    }

    /* Subscription and channel videos */
    ytd-rich-item-renderer.ytd-rich-grid-renderer {
        /* Fuck membership */
        &:has(ytd-badge-supported-renderer.ytd-rich-grid-media > div > badge-shape[aria-label ^= "Members"]) {
            .hide(@membersVideo);
        }

        /* Begone beggars */
        &:has(ytd-badge-supported-renderer.ytd-rich-grid-media > div > badge-shape[aria-label = "Fundraiser"]) {
            .hide(@fundraiserVideo);
        }

        /* Unverify raygun ðŸ”« */
        &:has(yt-content-metadata-view-model > div:first-child svg) {
            .hide(@verifiedVideo);
        }

        /* Jazz music stops (yup, another d selector yay ðŸŽ‰) */
        &:has(badge-shape.yt-badge-shape--thumbnail-default > .yt-badge-shape__icon svg > path[d = "M5.5 1.383V6.88a2.25 2.25 0 101 1.871V4.6l2.743 1.647a.5.5 0 00.757-.43V3.485a.5.5 0 00-.243-.429l-3.5-2.1a.5.5 0 00-.757.427Z"]) {
            .hide(@musicVideo);
        }

        /* Unalive yourself (fuck youtube for inconsistenly removing aria-label) */
        &:has(badge-shape.yt-badge-shape--thumbnail-live > .yt-badge-shape__icon svg > path[d = "M4.222 4.223a11 11 0 000 15.555 1 1 0 101.414-1.414 9 9 0 010-12.727 1 1 0 10-1.414-1.414Zm13.79.353a1 1 0 000 1.414 8.5 8.5 0 010 12.022 1 1 0 001.413 1.414 10.501 10.501 0 000-14.85 1 1 0 00-1.413 0Zm-2.83 2.827a1 1 0 000 1.414 4.501 4.501 0 010 6.365 1.001 1.001 0 001.414 1.414 6.5 6.5 0 000-9.193 1 1 0 00-1.415 0Zm-7.78 0a6.5 6.5 0 000 9.194 1 1 0 001.415-1.415 4.5 4.5 0 010-6.364 1.001 1.001 0 00-1.415-1.415ZM12 10a2 2 0 100 4 2 2 0 000-4Z"]) {
            .hide(@liveVideo);
        }

        /* Collab? More like shitting all over my feed ðŸ¤¬ */
        &:has(yt-avatar-stack-view-model) {
            .hide(@collabVideo);
        }
    }

    /* Recommended video */
    yt-lockup-view-model:is(.ytd-item-section-renderer, .ytd-watch-next-secondary-results-renderer) {
        /* Haven't seen any members-only video got recommended yet (thank goodness ðŸ˜‡) */
        /* Begone beggars (this might be not too accurate selector) */
        &:has(badge-shape.yt-badge-shape--commerce) {
            .hide(@fundraiserVideo);
        }

        /* Fuck AI dubbing (i don't like d attribute selector but ehhhhhhhhhhh) */
        &:has(badge-shape.yt-badge-shape--default > .yt-badge-shape__icon svg > path[d = "M19.4.2a1 1 0 00-.2 1.4 9 9 0 01-.022 10.83 1 1 0 001.595 1.206A11 11 0 0020.8.4a1 1 0 00-1.4-.2ZM10 2a5 5 0 100 10 5 5 0 000-10Zm6.17.3a1 1 0 00-.028 1.414c.895.932 1.365 2.114 1.358 3.312-.006 1.199-.49 2.378-1.396 3.302a1.001 1.001 0 101.427 1.4c1.257-1.281 1.959-2.953 1.969-4.69.009-1.738-.673-3.416-1.916-4.71A1 1 0 0016.17 2.3ZM10 13a8 8 0 00-8 8 1 1 0 001 1h14l.102-.005A1 1 0 0018 21a8 8 0 00-8-8Z"]) {
            .hide(@autoDubVideo);
        }

        /* Unverify raygun ðŸ”« */
        &:has(yt-content-metadata-view-model > div:first-child svg) {
            .hide(@verifiedVideo);
        }

        /* Jazz music stops (yup, another d selector yay ðŸŽ‰) */
        &:has(badge-shape.yt-badge-shape--thumbnail-default > .yt-badge-shape__icon svg > path[d = "M5.5 1.383V6.88a2.25 2.25 0 101 1.871V4.6l2.743 1.647a.5.5 0 00.757-.43V3.485a.5.5 0 00-.243-.429l-3.5-2.1a.5.5 0 00-.757.427Z"]) {
            .hide(@musicVideo);
        }

        /* Unalive yourself (fuck youtube for inconsistenly removing aria-label) */
        &:has(badge-shape.yt-badge-shape--thumbnail-live > .yt-badge-shape__icon svg > path[d = "M4.222 4.223a11 11 0 000 15.555 1 1 0 101.414-1.414 9 9 0 010-12.727 1 1 0 10-1.414-1.414Zm13.79.353a1 1 0 000 1.414 8.5 8.5 0 010 12.022 1 1 0 001.413 1.414 10.501 10.501 0 000-14.85 1 1 0 00-1.413 0Zm-2.83 2.827a1 1 0 000 1.414 4.501 4.501 0 010 6.365 1.001 1.001 0 001.414 1.414 6.5 6.5 0 000-9.193 1 1 0 00-1.415 0Zm-7.78 0a6.5 6.5 0 000 9.194 1 1 0 001.415-1.415 4.5 4.5 0 010-6.364 1.001 1.001 0 00-1.415-1.415ZM12 10a2 2 0 100 4 2 2 0 000-4Z"]) {
            .hide(@liveVideo);
        }

        /* Collab? More like shitting all over my feed ðŸ¤¬ */
        &:has(yt-avatar-stack-view-model) {
            .hide(@collabVideo);
        }
    }

    /* Probably remnant of an old UI? Only seen it for shorts */
    ytd-compact-video-renderer:is(.ytd-item-section-renderer, .ytd-watch-next-secondary-results-renderer) {
        /* Begone beggars (ARIA label is only predicted lmao) */
        &:has(ytd-badge-supported-renderer.ytd-compact-video-renderer > div > badge-shape[aria-label = "Fundraiser"]) {
            .hide(@fundraiserVideo);
        }

        /* Fuck AI dubbing */
        &:has(ytd-badge-supported-renderer.ytd-compact-video-renderer > div > badge-shape[aria-label = "Auto-dubbed"]) {
            .hide(@autoDubVideo);
        }

        /* Unverify raygun ðŸ”« */
        &:has(ytd-badge-supported-renderer.ytd-channel-name > div > badge-shape[aria-label = "Verified"]) {
            .hide(@verifiedVideo);
        }
    }

    /* Search result video */
    ytd-video-renderer.ytd-item-section-renderer {
        /* Collab? More like shitting all over my feed ðŸ¤¬ */
        &:has(yt-avatar-stack-view-model) {
            .hide(@collabVideo);
        }
    }

    /* Template for comment */
    .comment(has, @v) {
        /* Entire comment thread */
        ytd-comment-thread-renderer.ytd-item-section-renderer:has(> #comment-container > ytd-comment-view-model &),
        /* Comment reply */
        ytd-comment-view-model.ytd-comment-replies-renderer:has(&) {
            .hide(@v);
        }
    }

    .comment(is, @v) {
        /* Entire comment thread */
        ytd-comment-thread-renderer.ytd-item-section-renderer:has(> #comment-container > ytd-comment-view-model&),
        /* Comment reply */
        ytd-comment-view-model.ytd-comment-replies-renderer& {
            .hide(@v);
        }
    }

    /* Fuck super thanks */
    yt-pdg-comment-chip-renderer.ytd-comment-view-model#paid-comment-chip:not([hidden]) {
        .comment(has, @superThanksComment);
    }

    /* Members gets findommed */
    [has-sponsor-badge] {
        .comment(is, @membersComment);
    }

    /* Fuck preferential treatment */
    ytd-comment-engagement-bar.ytd-comment-view-model#action-buttons > #toolbar > #creator-heart:not(:empty) {
        .comment(has, @heartComment);
    }

    /* Verify my ass */
    [has-author-badge] {
        .comment(is, @verifiedComment);
    }

    /* Pin::into_inner_unchecked */
    [pinned] {
        .comment(is, @pinnedComment);
    }

    /* Fucking hate those mobile-only "feature" */
    [has-voice-reply] {
        .comment(is, @voiceComment);
    }

    /* More bullshit comment "feature" (instead of simple image/gif) ðŸ™„
     * https://www.reddit.com/r/youtube/comments/1oz1ume/i_found_a_way_to_reply_with_images_in_youtube/
     *
     * Might be not too accurate, but:
     * 1. You typically can't put links into comment/reply.
     * 2. It's the only child, fingers crossed nobody post only one link to shorts and some text.
     *
     * And no, you can't select text node:
     * - https://stackoverflow.com/questions/28855070/css-select-element-without-text-inside
     * - https://stackoverflow.com/questions/5688712/is-there-a-css-selector-for-text-nodes
    **/
    yt-attributed-string.ytd-comment-view-model#content-text > span.yt-core-attributed-string > span:only-child > a[href ^= "/shorts/"] {
        .comment(has, @shortsComment);
    }

    /* Motherfucking LINE sticker clone from Tokopedia (â•¯â€µâ–¡â€²)â•¯ï¸µâ”»â”â”» */
    yt-emoji-picker-upsell-category-renderer.yt-emoji-picker-renderer {
        .hide(@upsellEmoji);
    }

    /* Live chat */
    .yt-live-chat-item-list-renderer {
        /* Your supachatto is useless here ðŸ˜ˆ */
        yt-live-chat-paid-message-renderer& {
            .hide(@superChat);
        }

        /* A new memberslave has joined the cult ðŸ§›â€â™‚ï¸ */
        yt-live-chat-membership-item-renderer& {
            .hide(@membersChat);
        }

        /* Live chat item */
        yt-live-chat-text-message-renderer& {
            /* Fuck your membership in particular */
            &[author-type = "member"] {
                .hide(@membersChat);
            }

            /* Moderator? More like instigator amirite */
            &[author-type = "moderator"] {
                .hide(@moderatorChat);
            }

            /* g8 pwnd m8 ðŸ˜Ž */
            &[author-type = "owner"] {
                .hide(@ownerChat);
            }
        }

        /* Youtube chat is some of the most retarded alive */
        yt-live-chat-viewer-engagement-message-renderer& {
            /* Hideous replacement here */
            .handle(replace) {
                &:not(:hover) {
                    #message-container {
                        .replace(after,
                        "Youtube wants to fuck over your right to troll! Do crime, be gay, fuck \22 community\22  guidelines ðŸ˜Ž. (Hover over to \22restore\22  to original)");
                    }

                    #action-button > yt-button-renderer.yt-live-chat-viewer-engagement-message-renderer {
                        .hide(soft-hide);
                    }
                }
            }

            .handle(@v) {
                .hide(@v);
            }

            .handle(@chatInfoBox);
        }
    }

    /* Thingy above live chat */
    .yt-live-chat-ticker-renderer {
        /* Ain't gonna brag about membership */
        yt-live-chat-ticker-sponsor-item-renderer& {
            .hide(@membersChat);
        }

        /* Shush your superchat */
        yt-live-chat-ticker-paid-message-item-renderer& {
            .hide(@superChat);
        }
    }

    /* Artificial Idiot box is back in style ðŸ˜Ž */
    ytd-expandable-metadata-renderer:is(.ytd-watch-flexy, .ytd-structured-description-content-renderer):has(> #content > video-summary-content-view-model) {
        /* Hideous replacement here */
        .handle(replace) {
            &:not(:hover) {
                #expanded-title-subtitle-text {
                    > #expanded-title:first-child {
                        .replace(before, "ðŸ¤– Beep Boop I Am An Idiot");
                    }

                    > #expanded-subtitle > a {
                        .replace(before, "Youtube did not do QA", "yt-formatted-string:first-child");
                    }
                }

                #collapsed-label {
                    .replace(after, "Retard Box", "yt-formatted-string");
                }

                p {
                    .replace(after, "Youtube wants to artificially sand your intelligence off. With our infinite wisdom, we replaced this bullshit, useless box, that you won\'t ever read with our own text ðŸ¤ª. (Hover over to \22restore\22  to original)");
                }

                #collapsed-title {
                    .replace(after, "â›” Spoiler blocker â›” (Hover over to \22restore\22  to original)");
                }

                like-button-view-model {
                    display: none;
                }
            }
        }

        .handle(@v) {
            .hide(@v);
        }

        .handle(@aiSummary);
    }

    /* Dumb & indoctrinated by big tech ðŸ¤– */
    #teaser-carousel.ytd-watch-metadata:has(yt-carousel-item-view-model:is([aria-label = "Ask & learn"], [aria-label = "Ask"])) {
        /* Hideous replacement here */
        .handle(replace) {
            &:not(:hover) {
                yt-carousel-title-view-model > div {
                    &:first-child {
                        font-size: 1.4rem;
                        line-height: 2rem;
                        font-weight: 500;

                        .replace(after, "Dumb & Indoctrinate");
                    }

                    &.ytCarouselTitleViewModelNavigation {
                        display: none;
                    }
                }

                yt-text-carousel-item-view-model {
                    font-size: calc(1.4rem * 0.6);
                    line-height: calc(2rem * 0.6);

                    .replace(before, "Ministry of truth wants you to submit to AI overlords. With our infinite wisdom, we replaced this bullshit, useless box, that you won\'t ever read with our own text ðŸ˜. (Hover over to \22restore\22  to original)");
                }
            }
        }

        .handle(@v) {
            .hide(@v);
        }

        .handle(@aiSummary);
    }

    /* Fuck your freedom to think */
    #clarify-box.attached-message {
        /* Hideous replacement here */
        .handle(replace) {
            &:not(:hover) {
                h2 yt-formatted-string {
                    .sandwich("Youtube want to dictate your knowledge about \22", "\22  (massive air quotes there ðŸ˜‰)");
                }

                #paragraph {
                    .replace(after, "Youtube wants to tell you to fuck your agency right off. With our infinite wisdom, we replaced this bullshit, useless box, that you won\'t ever read with our own text ðŸ¤£. (Hover over to \22restore\22  to original)");
                }

                yt-formatted-string.disclaimer {
                    > span:first-child {
                        display: none;
                    }

                    &::before {
                        content: "Disclaimer: Alphabet Inc. is wholly responsible for this ðŸ’©.";
                    }

                    > a:last-child::after {
                        content: " (or don't)";
                    }
                }
            }
        }

        .handle(@v) {
            .hide(@v);
        }

        .handle(@clarifyBox);
    }

    /* Thanks for taking half the description box ðŸ˜‘ */
    #teaser-carousel.ytd-watch-metadata {
        .handle(smaller) {
            min-width: 0px;
            flex-basis: calc(100%/3);
            flex-grow: 0;
            flex-shrink: 1;
        }

        .handle(@v) {
            .hide(@v);
        }

        .handle(@teaserCarousel);
    }

    /* Fuck membership xðŸ’¯ */
    :is(yt-flexible-actions-view-model, ytd-video-owner-renderer.ytd-watch-metadata) > :has(button[aria-label = "Join this channel"]) {
        .hide(@joinButton) !important;
    }

    /* Might not be exactly join "button" but it's fucking annoying
     * (To future maintainer, it's a members showcase thingy in channel homepage)
    **/
    ytd-item-section-renderer.ytd-section-list-renderer:has(ytd-recognition-shelf-renderer) {
        .hide(@joinButton);
    }

    /* Button beside like/dislike */
    yt-button-view-model.ytd-menu-renderer {
        /* Share the my ass */
        &:has(> button-view-model > button[aria-label = "Share"]) {
            .hide(@shareButton);
        }

        /* Ik it's youtube thing but IMHO it's useless af */
        &:has(> button-view-model > button[aria-label = "Save to playlist"]) {
            .hide(@saveButton);
        }

        /* No thanks ðŸ‘®â€â™‚ï¸ðŸ¤š */
        &:has(> button-view-model > button[aria-label = "Thanks"]) {
            .hide(@superThanksButton);
        }

        /* Clip my goatse */
        &:has(> button-view-model > button[aria-label = "Clip"]) {
            .hide(@clipButton);
        }

        /* Unbuttons your AI ðŸ˜² */
        &:has(> button-view-model > button[aria-label = "Ask"]) {
            .hide(@aiButton);
        }
    }

    /* No thanks and you're not super ðŸ¦¸â€â™‚ï¸ðŸ¤š */
    yt-live-chat-app #picker-buttons > #product-picker:not([hidden]) {
        .hide(@superChatButton);
    }

    /* YT-DLP FTW!!!!! ðŸ˜Ž */
    ytd-download-button-renderer.ytd-menu-renderer {
        .hide(@downloadButton);
    }

    /* Top bar buttons */
    ytd-button-renderer.ytd-masthead {
        /* Fuschia is not a creative color */
        &:has(> yt-button-shape > button[aria-label = "Create"]) {
            .hide(@createButton) !important;
        }

        /* Who the fuck use voice search ðŸ¤¨ */
        &:has(> yt-button-shape > button[aria-label = "Search with your voice"]) {
            .hide(@mikeSearchButton);
        }
    }
}
